---
title: "p8105_hw3_jj3205"
author: "Jia Ji (jj3205)"
date: "2022-10-15"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem 1

```{r}
library(p8105.datasets)
data("instacart")

```

## Problem 2

```{r}
library(dplyr)
library(tidyverse)
library(readxl)

acce_df = 
  read_csv("data/accel_data.csv") %>%
  pivot_longer(
    cols = activity.1:activity.1440,
    names_to = "activity_number",
    values_to = "activity_counts",
    names_prefix = "activity.",
  ) %>% 
  mutate(
    is_weekend = (day == "Saturday" | day == "Sunday"),
    day = factor(day, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
  )
acce_df
```


The accel_data_clean dataset contains `r nrow(accel_data_clean)` observations and `r ncol(accel_data_clean)` variables.   
The variables records these information for each observation: week, day_id, which day in a week, is it weekend or not, activity number, and activity counts.   

Traditional analyses of accelerometer data focus on the total activity over the day. Using the tidied dataset, we will aggregate across minutes to create a total activity variable for each day, and create a table showing these totals.


```{r message = FALSE}
total_activity = 
  acce_df %>% 
  group_by(week, day) %>% 
  summarise(total_activity = sum(activity_counts)) %>% 
  pivot_wider(
    names_from = "day", 
    values_from = "total_activity"
  )
knitr::kable(total_activity)
```


From the table, we can see that as time passes day by day, the total activity counts were oscillating up and down. And activity counts on weekends are relatively lower than the counts on weekdays. 

Accelerometer data allows the inspection activity over the course of the day. Now we will make a single-panel plot that shows the 24-hour activity time courses for each day and use color to indicate day of the week. 


```{r fig.width = 8, fig.height = 4, dpi = 300, warning = FALSE, message = FALSE}
acce_df %>% 
  mutate(activity_number = as.numeric(activity_number)) %>% 
  group_by(day, activity_number) %>% 
  summarize(avg_value = mean(activity_counts)) %>% 
  ggplot(aes(x = activity_number, y = avg_value, color = day)) +
  geom_smooth() +
  scale_x_continuous(
    breaks = (0:23)*60 + 1,
    labels = c(0:23),
    name = "Hours in a Day"
  ) + 
  labs(
    title = "24-Hour Activity Time Courses for Each Day",
    x = "Activity Number (hrs)",
    y = "Average Activity Counts",
    color = "Day of the Week"
  ) +
  theme(legend.position = "right")
```


The average activity counts for all days in a week are the lowest during the time period of around 23:50 p.m. to 6:00 a.m, because at this period the test subject is sleeping and cannot move around frequently.  
There are also significant higher peaks of average activity counts at around 10:30 a.m of Sunday and around 21:00 p.m of Friday. This is probably because the test subject was doing some special activity (like doing exercises).


## Problem 3

```{r}



```

